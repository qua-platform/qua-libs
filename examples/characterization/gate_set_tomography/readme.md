# Gate Set Tomography with QUA

This script presents how one can perform Gate Set Tomography using a smart combination of the open-source package PyGSTi (https://github.com/pyGSTio/pyGSTi) and QUA for an efficient computation.

Reference: https://arxiv.org/pdf/2009.07301.pdf
# Introduction

Whereas usual state and process tomography do assume the existence of pre-calibrated gates allowing perfect state preparation and measurement stages, gate set tomography aims to perform a characterization which does not require any prior calibration or assumptions on the gates we use.
The way it is performed is by the description of an entire gate set that includes State Preparation and Measurement (SPAM) procedures. Where there exist multiple ways to address the GST sequence generation and post processing, we are interested here in proposing a nice way of using QUA to actually run the GST experiment in the lab, once the circuit list to be run has been generated using the GST models included in the PyGSTi package.

# 1. Reading the txt file originating from PyGSTi
The GST experiment can usually be broken down in a list of circuits that do have the same structure:
- State preparation stages, also called state fiducials
- Germs, which do amplify in all directions the sources of noise associated to each basis gate. It is usually repeated $$p$$ times where $$p$$ is an integer and can vary depending on the experiment conducted
- Measurement stages, also called measurement fiducials

The idea is to extract this structure from the txt file and the GST model generated by the PyGSTi package in order to build a set of inputs readable by the QUA program which will perform the play statements necessary to produce the circuit lists.
To do that, we must build a correspondence between a certain gate sequence indicated with basic names within the txt file, and a set of QUA macros which are containing a series of play statements that will actually implement the targeted gate sequences.

Ilan's part ()

# 2. Loading the encoded sequences in the OPX using the IO variables
GST experiments can be quite expensive in terms of computational resources as the list of circuits that can be run in one experiment can be extremely long. In order to run them in one single QUA program, we load iteratively the variables using the two IO variables using the function *encode_circuit_in_IO().* This carries the advantage of not having to launch a new QUA program for each iteration when saturating memory. 